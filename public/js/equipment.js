var equipment={init:function(){this.events()},events:function(){$(".td-navigation .next").click(function(){var g=$(this).closest("td");g.trigger("mouseleave");var a=g.find(".items");equipment.el_height(a);var f=a.find(".item.active");var b=f.next();if(b.length!=1){b=a.children(":first-child")}f.removeClass("active").addClass("hidden");b.removeClass("hidden").addClass("active");g.trigger("mouseenter");var d=parseInt(g.find(".td-navigation .total").html());var c=g.find(".td-navigation .current");var e=parseInt(c.html());e++;if(e>d){e=1}c.html(e);equipment.stat_summary(g)});$(".td-navigation .previous").click(function(){var g=$(this).closest("td");g.trigger("mouseleave");var a=g.find(".items");equipment.el_height(a);var f=a.find(".item.active");var d=f.prev();if(d.length!=1){d=a.children(":last-child")}f.removeClass("active").addClass("hidden");d.removeClass("hidden").addClass("active");g.trigger("mouseenter");var c=parseInt(g.find(".td-navigation .total").html());var b=g.find(".td-navigation .current");var e=parseInt(b.html());e--;if(e==0){e=c}b.html(e);equipment.stat_summary(g)});$("td").mouseenter(this.compare);$("td").mouseleave(this.uncompare);$("#craftable_only_switch").change(function(){$(this).closest("form").submit()});$("tbody tr:first-child td").each(function(){equipment.stat_summary($(this))});$(".stat-toggle").click(function(){var a=$(this);var b=a.data("stat");a.toggleClass("opaque");$('.item .stats-box .stat[data-stat="'+b+'"]').toggleClass("hidden");$('tfoot .stat[data-stat="'+b+'"]').toggleClass("hidden")});$("#craft_these").click(function(){var b=$("#craft_level").val(),h=$("#craft_slot").val(),e=$("#craft_status").val();var c=[];if(b=="all"){$("#craft_level option:not(:first-child)").each(function(){c[c.length]=$(this).val()})}else{c[0]=b}var k=[];if(h=="all"){$("#craft_slot option:not(:first-child)").each(function(){k[k.length]=$(this).val()})}else{k[0]=h}var a=[];for(var f=0;f<c.length;f++){for(var d=0;d<k.length;d++){var g=$("#gear tbody tr:nth-child("+k[d]+") td:nth-child("+c[f]+")");console.log(e,g);if(e=="new"&&!g.hasClass("alert")){continue}if(g.find(".item.active.craftable").length>0){a[a.length]=g.find(".item.active").data("itemId")}}}a=unique(a);window.location="/crafting/gear?"+a.join(":")+":1"})},el_height:function(a){a.css("min-height",a.height())},compare:function(){var c=$(this);equipment.el_height(c.find(".items"));var a=c.find(".item.active .stats-box");var b=c.prev("td").find(".item.active .stats-box");a.find(".stat").each(function(){var d=$(this);var e=b.find('.stat[data-stat="'+d.data("stat")+'"]');if(e.length==0){d.find("span").html("+"+d.data("amount"))}else{var f=parseInt(d.data("amount"))-parseInt(e.data("amount"));d.find("span").html((f>=0?"+":"")+f)}})},uncompare:function(){$(this).find(".stats-box .stat").each(function(){var a=$(this);a.find("span").html(a.data("amount"))})},stat_summary:function(b){if(b.hasClass("no-summary")){return}var i=b.closest("tr").children().index(b);var g=[],h=[];$("tbody tr td:nth-child("+(i+1)+")").each(function(){$(this).find(".item.active .stat").each(function(){var l=$(this);var k=l.data();if(l.hasClass("hidden")){h[h.length]=k.stat}if(typeof(g[k.stat])==="undefined"){g[k.stat]=0}g[k.stat]+=k.amount})});var e=$("tfoot tr:first-child th:nth-child("+(i+1)+") .stats-box");e.html("");for(var d in g){var f=g[d];var a=$("<div>");if(h.indexOf(d)>-1){a.addClass("hidden")}a.addClass("col-sm-6").addClass("text-center").addClass("stat").attr("data-stat",d).attr("data-amount",f);var j=$("<span>");j.html("+"+f+" &nbsp; ");var c=$("<img>");c.attr("src","/img/stats/"+d+".png").addClass("stat-icon").attr("rel","tooltip").attr("title",d);a.append(j);a.append(c);e.append(a)}}};$(equipment.init());function unique(a){return $.grep(a,function(c,b){return b==$.inArray(c,a)})};