var leves={init:function(){leves.events(),leves.decipher_hash(),leves.search()},decipher_hash:function(){var e=document.location.hash;return""!=e&&(e=e.slice(1).split("|"),$("#class-selector").multiselect("deselect","CRP").multiselect("select",e[0].split(",")),$("#min-level").val(e[1]),$("#max-level").val(e[2]),$("#type-selector").multiselect("deselect",["Town","Courier","Field"]).multiselect("select",e[3].split(",")),"1"==e[4]&&$("#repeatable_only").prop("checked",!0),""==e[5]&&""==e[6]&&""==e[7]||$(".toggle-advanced").trigger("click"),$("#leve_item").val(e[5]),$("#leve_name").val(e[6]),$("#leve_location").val(e[7]),!0)},events:function(){$("#class-selector").multiselect({buttonClass:"btn",buttonWidth:"auto",buttonContainer:'<div class="btn-group" />',maxHeight:!1,includeSelectAllOption:!0,buttonText:function(e){if(0==e.length)return'None selected <b class="caret"></b>';if(1==e.length)return'<img src="/img/jobs/'+$(e[0]).val().toUpperCase()+'-active.png" width="24" height="24"> <b class="caret"></b>';if(e.length>1)return e.length+' selected  <b class="caret"></b>';var t="";return e.each(function(){t+=$(this).text()+", "}),t.substr(0,t.length-2)+' <b class="caret"></b>'}}),$("#type-selector").multiselect({buttonClass:"btn",buttonWidth:"auto",buttonContainer:'<div class="btn-group" />',maxHeight:!1,includeSelectAllOption:!0,buttonText:function(e){if(0==e.length)return'None selected <b class="caret"></b>';if(e.length>1)return e.length+' selected  <b class="caret"></b>';var t="";return e.each(function(){t+=$(this).text()+", "}),t.substr(0,t.length-2)+' <b class="caret"></b>'}}),$(".leve-form").submit(function(e){e.preventDefault(),leves.search()}),$(".leve-form .filter-form").click(function(e){e.preventDefault(),$(".leve-form").submit()}),$(".toggle-advanced").click(function(e){e.preventDefault(),$(".advanced").toggleClass("hidden"),$(".advanced input").val("")}),$(".leve-text-search").keyup(function(e){13==e.which&&leves.search()}),$("#min-level, #max-level").change(function(){var e=$(this),t=parseInt(e.attr("min")),l=parseInt(e.attr("max")),a=parseInt(e.val());if(e.is("#max-level")){var n=parseInt($("#min-level").val());a<n&&(e.val(n),a=n)}else{var s=parseInt($("#max-level").val());a>s&&(e.val(s),a=s)}a<t&&(a=t),a>l&&(a=l),e.val(a)}),$("#save-setup").click(function(e){e.preventDefault(),global.set_cookie("previous_leve_load",document.location.hash),global.noty({type:"success",text:"Setup Saved"})}),$("#load-setup").click(function(e){e.preventDefault(),global.noty({type:"info",text:"Loading Setup"}),document.location.hash=decodeURIComponent(global.get_cookie("previous_leve_load")),leves.decipher_hash(),leves.search()})},search:function(){var e=[],t=[],l=$("#repeatable_only").is(":checked"),a=parseInt($("#min-level").val()),n=parseInt($("#max-level").val()),s=$("#leve_item").val(),c=$("#leve_name").val(),o=$("#leve_location").val();$("#class-selector + .btn-group input:checked").each(function(){e[e.length]=$(this).val()}),$("#type-selector + .btn-group input:checked").each(function(){t[t.length]=$(this).val()}),document.location.hash=[e.join(","),a,n,t.join(","),1==l?1:0,s,c,o].join("|"),$(".leve_rewards").popover("destroy"),$.ajax({url:"/levequests/populate-advanced",type:"get",dataType:"html",data:{classes:e,types:t,repeatable_only:l,min_level:a,max_level:n,leve_item:s,leve_name:c,leve_location:o},beforeStart:function(){global.noty({type:"info",text:"Searching for Leves"})},success:function(e){$(".leve-table tbody").html(e),global.reset_popovers(),$("[rel=tooltip]").tooltip(global.tooltip_options)}})}};$(leves.init);