var quests={init:function(){quests.events(),quests.decipher_hash(),quests.search()},decipher_hash:function(){var e=document.location.hash;return""!=e&&(e=e.slice(1).split("|"),$("#class-selector").multiselect("deselect","CRP").multiselect("select",e[0].split(",")),$("#min-level").val(e[1]),$("#max-level").val(e[2]),$("#quest_item").val(e[3]),!0)},events:function(){$("#class-selector").multiselect({buttonClass:"btn",buttonWidth:"auto",buttonContainer:'<div class="btn-group" />',maxHeight:!1,includeSelectAllOption:!0,buttonText:function(e){if(0==e.length)return'None selected <b class="caret"></b>';if(1==e.length)return'<img src="/img/jobs/'+$(e[0]).val().toUpperCase()+'-active.png" width="24" height="24"> <b class="caret"></b>';if(e.length>1)return e.length+' selected  <b class="caret"></b>';var t="";return e.each(function(){t+=$(this).text()+", "}),t.substr(0,t.length-2)+' <b class="caret"></b>'}}),$(".quest-form").submit(function(e){e.preventDefault(),quests.search()}),$(".quest-form .filter-form").click(function(e){e.preventDefault(),$(".quest-form").submit()}),$(".quest-text-search").keyup(function(e){13==e.which&&quests.search()}),$("#min-level, #max-level").change(function(){var e=$(this),t=parseInt(e.attr("min")),s=parseInt(e.attr("max")),a=parseInt(e.val());if(e.is("#max-level")){var l=parseInt($("#min-level").val());a<l&&(e.val(l),a=l)}else{var n=parseInt($("#max-level").val());a>n&&(e.val(n),a=n)}a<t&&(a=t),a>s&&(a=s),e.val(a)}),$("#save-setup").click(function(e){e.preventDefault(),global.set_cookie("previous_quest_load",document.location.hash),global.noty({type:"success",text:"Setup Saved"})}),$("#load-setup").click(function(e){e.preventDefault(),global.noty({type:"info",text:"Loading Setup"}),document.location.hash=decodeURIComponent(global.get_cookie("previous_quest_load")),quests.decipher_hash(),quests.search()})},search:function(){var e=[],t=parseInt($("#min-level").val()),s=parseInt($("#max-level").val()),a=$("#quest_item").val().toLowerCase();$("#class-selector + .btn-group input:checked").each(function(){e[e.length]=$(this).val()}),document.location.hash=[e.join(","),t,s,a].join("|"),$("tr.quest").each(function(){var l=$(this),n=$("td span.name",l).html().toLowerCase(),i=parseInt($("td span.level",l).html()),c=l.data("abbr"),o=!0;""!=a&&n.indexOf(a)<0&&(o=!1);for(var r=!1,u=0;u<e.length;u++)if(e[u]==c){r=!0;break}0==r&&(o=!1),(t>i||i>s)&&(o=!1),l[(o?"remove":"add")+"Class"]("hidden")})}};$(quests.init);