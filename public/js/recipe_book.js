var recipe_book={init:function(){recipe_book.events(),recipe_book.decipher_hash()},hash_per_page:null,decipher_hash:function(){var e=document.location.hash;return""!=e&&(e=e.slice(1).split("|"),$("#name-search input").val(e[0]),$("#min-level").val(e[2]),$("#max-level").val(e[3]),$("#order-by").val(e[5]),recipe_book.hash_per_page=e[4],$("#class-search button").data("class")==e[1]?recipe_book.search():$("#class-search [data-class="+e[1]+"]").trigger("click"),recipe_book.hash_per_page=null,!0)},events:function(){$("#name-search input").keyup(function(e){if(13!=e.which)return!0;1==recipe_book.check_input_length()&&recipe_book.search()}),$("#name-search button").click(function(){1==recipe_book.check_input_length()&&recipe_book.search()}),$("#order-by").change(function(e){return recipe_book.search()}),$("#min-level, #max-level").change(function(){var e=$(this),a=parseInt(e.attr("min")),o=parseInt(e.attr("max")),t=parseInt(e.val());if(e.is("#max-level")){var n=parseInt($("#min-level").val());t<n&&(e.val(n),t=n)}else{var r=parseInt($("#max-level").val());t>r&&(e.val(r),t=r)}t<a&&(t=a),t>o&&(t=o),e.val(t),recipe_book.search()}),$("#class-search li a").click(function(e){e.preventDefault();var a=$(this),o=$("#class-search button"),t=a.data("class"),n=$("img",a),r=o.data("class");old_img=$("img",o),t!=r&&(n.clone().insertAfter(old_img),old_img.remove(),o.data("class",t),recipe_book.search())}),$(document).on("change","#per_page",function(){recipe_book.search()}),$("#save-setup").click(function(e){e.preventDefault(),global.set_cookie("previous_recipe_load",document.location.hash),global.noty({type:"success",text:"Setup Saved"})}),$("#load-setup").click(function(e){e.preventDefault(),global.noty({type:"info",text:"Loading Setup"}),document.location.hash=decodeURIComponent(global.get_cookie("previous_recipe_load")),recipe_book.decipher_hash(),recipe_book.search()})},check_input_length:function(){var e=$("#name-search input").val();return $("#name-search").removeClass("has-error"),!(e.length<3&&e.length>0)||($("#name-search").addClass("has-error"),global.noty({type:"error",text:"Minimum 3 letter search limit"}),!1)},search:function(e){var a=$("#name-search input").val(),o=$("#min-level").val(),t=$("#max-level").val(),n=$("#class-search button").data("class"),r=$("#per_page").val(),c=$("#order-by").val();null!=recipe_book.hash_per_page&&(r=recipe_book.hash_per_page),void 0===e&&(e=""),document.location.hash=[a,n,o,t,r,c].join("|"),$.ajax({url:"/recipes/search"+e,dataType:"json",data:{name:a,min:o,max:t,class:n,per_page:r,sorting:c},beforeSend:function(){recipe_book.disable(),global.noty({type:"information",text:"Searching Recipe Book"})},success:function(e){$("#recipe-book tbody").html(e.tbody),$("#recipe-book tfoot").html(e.tfoot),recipe_book.table_events()},complete:function(){recipe_book.enable()}})},table_events:function(){$("#recipe-book tfoot .pagination a").click(function(e){e.preventDefault(),recipe_book.search(e.target.search)}),global.trigger_xivdb_tooltips()},disable:function(){$("#name-search input, #name-search button, #order-by, #min-level, #max-level, #class-search button").addClass("disabled"),$("#name-search input, #order-by, #min-level, #max-level").prop("disabled",!0)},enable:function(){$("#name-search input, #name-search button, #order-by, #min-level, #max-level, #class-search button").removeClass("disabled"),$("#name-search input, #order-by, #min-level, #max-level").prop("disabled",!1)}};$(recipe_book.init);